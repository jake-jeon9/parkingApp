<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.agencyMapper">
	<!-- agency -->
	<!-- agency insert -->
	<insert id="agencyInsert" parameterType="agencyDTO">
		INSERT INTO Agency 
		VALUES     (seq_agency.nextval, 
		            #{memberNo}, 
		            #{nameOfAgency}, 
		            #{contactName},
		            #{contacnPhone},
		            sysdate,
		            add_months(sysdate,#{expireOfDate}),
		            0,
		            #{paid},
		            0)
	</insert>
	<!-- agency modify -->
	<update id="agencyModify" parameterType="agencyDTO" >
		UPDATE agency 
		SET    contactName = #{contactName}, 
		       contacnPhone = #{contacnPhone}, 
		       expireOfDate = #{expireOfDate},
			   countOfextend = #{countOfextend},
			   paid = #{paid}
		WHERE  agencyNo = #{agencyNo} 
	</update>
	
	<!-- update count -->
	<update id="agencyUpdate" parameterType="int" >
		UPDATE agency 
		SET 	usedCount = usedCount+1
		WHERE	agencyNo = 2;
	</update>
	
	<!-- delete agency -->
	<delete id="agencyDelete" parameterType=int >
		DELETE FROM agency 
		WHERE  agencyNo = #{agencyNo}
	</delete>
	
	<!-- list agency -->
	<select id="agencySelect" parameterType="int" resultType="agencyDTO">
		SELECT * FROM agency
		WHERE memberNo = #{memberNo}
	</select>
	
</mapper>